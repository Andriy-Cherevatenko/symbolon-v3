import React from 'react';
import Reducer from '../reducers';
import Immutable from 'immutable';
import Articles from '../components/Articles';
import ACTIONS from '../actions';
import Enzyme, { mount } from 'enzyme';
import EnzymeAdapter from 'enzyme-adapter-react-16';

Enzyme.configure({ adapter: new EnzymeAdapter() });

describe('menuReducer:', () => {
    it('should return the initial state', () => {
        const initialState = Immutable.Map({
            article: <Articles.BlankPage />,
            selectedCards: [],
        });
        const initialStateToBeTested = Reducer(undefined, {});

        expect(initialStateToBeTested).toEqual(initialState);
    });

    it(`should handle payload "Aries" correctly (array is empty)`, () => {
        const zodiacName = 'Aries';
        const initialState = Immutable.Map({
            article: <Articles.BlankPage />,
            selectedCards: [],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual([zodiacName]);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('Aries Component');
    });

    it(`should handle payload "Aries" correctly (Aries already in array)`, () => {
        const zodiacName = 'Aries';
        const initialState = Immutable.Map({
            article: <Articles.Aries />,
            selectedCards: ['Aries'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual([]);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('BlankPage Component');
    });

    it(`should handle payload "Aries" correctly (Taurus in array)`, () => {
        const zodiacName = 'Aries';
        const initialState = Immutable.Map({
            article: <Articles.Taurus />,
            selectedCards: ['Taurus'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual([zodiacName, 'Taurus']);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('AriesTaurus Component');
    });

    it(`should handle payload "Aries" correctly (Aries and Taurus in array)`, () => {
        const zodiacName = 'Aries';
        const initialState = Immutable.Map({
            article: <Articles.AriesTaurus />,
            selectedCards: ['Aries', 'Taurus'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual(['Taurus']);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('Taurus Component');
    });

    it(`should handle payload "Taurus" correctly (Aries and Taurus in array)`, () => {
        const zodiacName = 'Taurus';
        const initialState = Immutable.Map({
            article: <Articles.AriesTaurus />,
            selectedCards: ['Aries', 'Taurus'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual(['Aries']);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('Aries Component');
    });

    it(`should handle payload "Cancer" correctly (Aries and Taurus in array)`, () => {
        const zodiacName = 'Cancer';
        const initialState = Immutable.Map({
            article: <Articles.AriesTaurus />,
            selectedCards: ['Aries', 'Taurus'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual(['Cancer']);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('Cancer Component');
    });

    it(`should handle payload "Taurus" correctly (Aries in array)`, () => {
        const zodiacName = 'Taurus';
        const initialState = Immutable.Map({
            article: <Articles.Taurus />,
            selectedCards: ['Aries'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual(['Aries', zodiacName]);
        const page = mount(nextState.get('article'));
        expect(page.text()).toBe('AriesTaurus Component');
    });

    it(`should handle correctly if switch check causes break`, () => {
        const zodiacName = 'Cancer';
        const initialState = Immutable.Map({
            article: <Articles.AriesTaurus />,
            selectedCards: ['Aries', 'Taurus', 'Taurus'],
        });
        const nextState = Reducer(initialState, {
            type: ACTIONS.SELECT_ZODIAC_SIGN,
            zodiacName,
        });

        expect(nextState.get('selectedCards')).toEqual([
            'Aries',
            'Taurus',
            'Taurus',
        ]);
    });
});